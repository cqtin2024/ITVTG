<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω Gi·∫£i ƒê·∫•u & C·∫≠p Nh·∫≠t Th√¥ng Tin (GitHub Sync) V6.5 - DEV</title> 
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;400;700;900&display=swap" rel="stylesheet">
    <style>
        /* Base styles for Dark Mode */
        :root {
            --bg-color: #111827; 
            --text-color: #f3f4f6; 
            --card-bg: #1f2937; 
            --border-color: #374151; 
            --accent-color: #06b6d4; 
            --match-bg: #1f2937;
            --input-bg: #4b5563; 
            --group-header-text: #60a5fa; 
        }
        
        /* Light Mode Overrides */
        .light-mode {
            --bg-color: #f9fafb; 
            --text-color: #111827; 
            --card-bg: #ffffff;
            --border-color: #e5e7eb; 
            --accent-color: #ef4444; 
            --match-bg: #f3f4f6; 
            --input-bg: #ffffff;
            --group-header-text: #10b981; 
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }
        .container {
            max-width: 1200px;
        }
        .score-input, .text-input {
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }
        .score-input:focus, .text-input:focus {
            box-shadow: 0 0 0 3px var(--accent-color);
        }
        .tab-button {
            border-bottom-color: var(--border-color);
        }
        .tab-button.active {
            color: var(--accent-color);
            border-color: var(--accent-color);
            background-color: var(--card-bg);
        }
        .tab-content {
            display: none;
            background-color: var(--card-bg);
            border-radius: 0.75rem; 
            padding: 1.5rem; 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); 
        }
        
        ::-webkit-scrollbar { height: 8px; }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6b7280; }
        
        .match-card {
            background-color: var(--match-bg);
            border-bottom: 1px solid var(--border-color);
        }
        .light-mode .match-card {
            background-color: #ffffff;
            border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="app" class="container mx-auto">
        <header class="flex items-center justify-between mb-6">
            <div class="flex items-center">
                <svg class="w-10 h-10 md:w-12 md:h-12 text-[var(--accent-color)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 15.75l-4-4m0 0l4-4m-4 4h14M17 12a5 5 0 11-10 0 5 5 0 0110 0z"></path></svg>
                <div class="text-left ml-4">
                    <h1 class="text-xl md:text-3xl font-extrabold text-[var(--text-color)] leading-none">QU·∫¢N L√ù GI·∫¢I ƒê·∫§U PICKLEBALL (V6.5)</h1>
                    <p class="text-xs md:text-sm text-[var(--accent-color)]">C·∫≠p Nh·∫≠t T·ªâ S·ªë & Th√¥ng Tin ƒê·ªôi (GitHub Sync) - FIXED</p>
                </div>
            </div>
            
            <button id="themeToggle" onclick="toggleTheme()" class="p-3 rounded-full bg-[var(--card-bg)] shadow-md text-[var(--text-color)] hover:bg-[var(--border-color)] transition duration-200">
                <svg id="sunIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                <svg id="moonIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
            </button>
        </header>

        <div id="statusMessage" class="text-center p-4 bg-blue-900/50 rounded-lg text-blue-300 font-semibold mb-6">
            ƒêang t·∫£i d·ªØ li·ªáu tr·∫°ng th√°i t·ª´ GitHub...
        </div>
        
        <nav class="mb-8 border-b border-[var(--border-color)] overflow-x-auto whitespace-nowrap">
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('General')" data-tab="General">General</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('TeamManagement')" data-tab="TeamManagement">Qu·∫£n L√Ω ƒê·ªôi</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('GroupA')" data-tab="GroupA">Group A</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('GroupB')" data-tab="GroupB">Group B</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('GroupC')" data-tab="GroupC">Group C</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('GroupD')" data-tab="GroupD">Group D</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('Knockout')" data-tab="Knockout">Knockout</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('Configuration')" data-tab="Configuration">C·∫•u H√¨nh</button>
        </nav>

        <div id="General" class="tab-content">
             <h2 class="text-3xl font-extrabold text-yellow-500 mb-6 border-b border-[var(--border-color)] pb-2">Final Results (K·∫øt qu·∫£ chung cu·ªôc)</h2>
            <section id="finalResults" class="mb-10 p-4 rounded-xl shadow-lg bg-[var(--match-bg)]">
                <div id="championDisplay" class="text-center">
                    <p class="text-4xl font-black text-yellow-500 mb-2">Ch∆∞a x√°c ƒë·ªãnh</p>
                    <p class="text-lg text-yellow-500">Nh√† V√¥ ƒê·ªãch Gi·∫£i ƒê·∫•u</p>
                </div>
                 <div id="runnerUpDisplay" class="text-center mt-4 border-t border-[var(--border-color)] pt-4">
                    <p class="text-2xl font-bold text-gray-400 mb-1">Ch∆∞a x√°c ƒë·ªãnh</p>
                    <p class="text-md text-gray-400">√Å Qu√¢n Gi·∫£i ƒê·∫•u</p>
                </div>
            </section>

            <h2 class="text-3xl font-extrabold text-[var(--text-color)] mb-6 border-b border-[var(--border-color)] pb-2">Team List (Danh s√°ch c√°c ƒë·ªôi)</h2>
            <section id="teamList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                </section>
        </div>
        
        <div id="TeamManagement" class="tab-content">
            <h2 class="text-3xl font-extrabold text-blue-500 mb-6 border-b border-[var(--border-color)] pb-2">Qu·∫£n L√Ω Th√¥ng Tin ƒê·ªôi (L∆∞u c·ª•c b·ªô)</h2>
            <p class="text-sm text-gray-400 mb-4">ƒêi·ªÅu ch·ªânh **T√™n ƒë·ªôi (Tn)**, **T√™n ng∆∞·ªùi ch∆°i (name)**, **C·∫•p ƒë·ªô (pL)**, v√† **NƒÉm sinh (bY)**. C√°c thay ƒë·ªïi n√†y ch·ªâ ƒë∆∞·ª£c l∆∞u c·ª•c b·ªô v√† **ch·ªâ ƒë∆∞·ª£c ƒë·ªìng b·ªô l√™n GitHub khi b·∫°n COMMIT T·ªà S·ªê** (s·ª≠ d·ª•ng file `state41s.json`).</p>
            
            <button id="saveTeamLocalButton" onclick="saveTeamChangesToLocal()" class="w-full md:w-auto px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-lg transition duration-300 mb-6">
                L∆ØU C√ÅC THAY ƒê·ªîI ƒê·ªòI C·ª§C B·ªò (Kh√¥ng Commit)
            </button>
            
            <div id="teamCommitResult" class="mt-3 p-3 rounded-lg text-sm font-semibold hidden"></div>

            <section id="teamManagementList" class="space-y-6"></section>
        </div>


        <div id="GroupA" class="tab-content space-y-6">
            <button onclick="simulateScores('A')" class="w-full md:w-auto px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                GI·∫¢ L·∫¨P T·ªà S·ªê V√íNG B·∫¢NG A
            </button>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div id="tableA" class="lg:col-span-1"></div>
                <div id="matchesA" class="lg:col-span-2"></div>
            </div>
        </div>

        <div id="GroupB" class="tab-content space-y-6">
            <button onclick="simulateScores('B')" class="w-full md:w-auto px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                GI·∫¢ L·∫¨P T·ªà S·ªê V√íNG B·∫¢NG B
            </button>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div id="tableB" class="lg:col-span-1"></div>
                <div id="matchesB" class="lg:col-span-2"></div>
            </div>
        </div>

        <div id="GroupC" class="tab-content space-y-6">
             <button onclick="simulateScores('C')" class="w-full md:w-auto px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                GI·∫¢ L·∫¨P T·ªà S·ªê V√íNG B·∫¢NG C
            </button>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div id="tableC" class="lg:col-span-1"></div>
                <div id="matchesC" class="lg:col-span-2"></div>
            </div>
        </div>

        <div id="GroupD" class="tab-content space-y-6">
             <button onclick="simulateScores('D')" class="w-full md:w-auto px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                GI·∫¢ L·∫¨P T·ªà S·ªê V√íNG B·∫¢NG D
            </button>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div id="tableD" class="lg:col-span-1"></div>
                <div id="matchesD" class="lg:col-span-2"></div>
            </div>
        </div>

        <div id="Knockout" class="tab-content">
            <h2 class="text-3xl font-extrabold text-[var(--group-header-text)] mb-6 border-b border-[var(--border-color)] pb-2">V√≤ng Lo·∫°i Tr·ª±c Ti·∫øp (Knockout Stage)</h2>
            <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-4 mb-6">
                <button onclick="seedKnockoutMatches()" id="seedButton" class="w-full md:w-auto px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-lg transition duration-300 disabled:opacity-50">
                    T·ª∞ ƒê·ªòNG X·∫æP C·∫∂P T·ª® K·∫æT (SEEDING)
                </button>
                <button onclick="simulateScores('Knockout')" class="w-full md:w-auto px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                    GI·∫¢ L·∫¨P T·ªà S·ªê V√íNG LO·∫†I (QF, SF, F)
                </button>
            </div>
            
            <div id="seedingStatus" class="p-3 bg-blue-900/30 text-blue-300 rounded-lg mb-6">
                Tr·∫°ng th√°i Seeding: Ch∆∞a kh·ªüi t·∫°o T·ª© k·∫øt.
            </div>
            
            <div id="quarterfinals" class="mb-6"></div>
            <div id="semifinals" class="mb-6"></div>
            <div id="finalMatchSection">
                <div id="finalSection"></div>
            </div>
        </div>

        <div id="Configuration" class="tab-content space-y-8">
            <h2 class="text-3xl font-extrabold text-red-500 mb-6 border-b border-[var(--border-color)] pb-2">C·∫•u H√¨nh & ƒê·ªìng B·ªô H√≥a (GitHub API)</h2>
            
             <section class="p-4 bg-red-900/20 rounded-lg border-l-4 border-red-500">
                <h3 class="text-xl font-bold text-red-400 mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                    1. GitHub Personal Access Token (PAT)
                </h3>
                <p class="text-sm text-red-300 mb-4 font-bold">C·∫¢NH B√ÅO B·∫¢O M·∫¨T: Token n√†y s·∫Ω ƒë∆∞·ª£c l∆∞u tr·ªØ trong tr√¨nh duy·ªát. Ch·ªâ s·ª≠ d·ª•ng Token c√≥ ph·∫°m vi (Scope) nh·ªè nh·∫•t. <span class="text-yellow-300">C·∫¶N PH·∫¢I C√ì QUY·ªÄN **repo** (ho·∫∑c contents:write)</span>.</p>
                <input type="password" id="githubToken" 
                    class="score-input w-full p-2 rounded-md focus:ring-red-500 transition" 
                    placeholder="D√°n GitHub PAT c·ªßa b·∫°n v√†o ƒë√¢y...">
                <button onclick="saveToken()" class="mt-2 px-4 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-bold rounded-lg transition duration-300">L∆∞u Token c·ª•c b·ªô</button>
            </section>

            <section class="p-4 bg-[var(--match-bg)] rounded-lg border-l-4 border-purple-500">
                <h3 class="text-xl font-bold text-[var(--group-header-text)] mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                    2. C·∫≠p Nh·∫≠t T·ªâ S·ªë (Commit) l√™n **state41s.json**
                </h3>
                <p class="text-gray-400 mb-4">S·ª≠ d·ª•ng Token ƒë√£ l∆∞u ƒë·ªÉ commit nh·ªØng t·ªâ s·ªë v√† th√¥ng tin ƒë·ªôi **ƒë√£ thay ƒë·ªïi** l√™n GitHub (file `state41s.json`).</p>
                
                <button id="commitScoreButton" onclick="commitScoreChangesToGitHub()" class="w-full md:w-auto px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-lg shadow-lg transition duration-300 mb-4 disabled:opacity-50">
                    COMMIT T·ªà S·ªê & THAY ƒê·ªîI ƒê·ªòI
                </button>

                <div id="scoreCommitResult" class="mt-3 p-3 rounded-lg text-sm font-semibold hidden"></div>
            </section>
            
             <section class="p-4 bg-[var(--match-bg)] rounded-lg border-l-4 border-green-500">
                 <h3 class="text-xl font-bold text-[var(--group-header-text)] mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                    3. Xu·∫•t D·ªØ Li·ªáu Gi·∫£i ƒê·∫•u (state41.json Format)
                </h3>
                <p class="text-[var(--text-color)] mb-4">T·∫°o v√† t·∫£i v·ªÅ file JSON ch·ª©a to√†n b·ªô tr·∫°ng th√°i gi·∫£i ƒë·∫•u hi·ªán t·∫°i, bao g·ªìm th√¥ng tin ƒë·ªôi v√† t·ªâ s·ªë ƒë√£ t√≠nh to√°n.</p>
                <button onclick="exportTournamentData()" class="md:w-auto px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                    T·∫¢I XU·ªêNG TO√ÄN B·ªò JSON
                </button>
                <div id="configExportResult" class="mt-3 p-3 rounded-lg text-sm font-semibold hidden"></div>
            </section>
            
            <section class="p-4 bg-[var(--match-bg)] rounded-lg border-l-4 border-red-500">
                <h3 class="text-xl font-bold text-red-400 mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                    4. X√≥a (Reset) T·ªâ S·ªë Tr·∫≠n ƒê·∫•u
                </h3>
                <p class="text-gray-400 mb-4">Ch·ªçn v√≤ng ƒë·∫•u v√† nh·∫•n n√∫t ƒë·ªÉ **X√ìA T·∫§T C·∫¢** t·ªâ s·ªë ƒë√£ nh·∫≠p trong v√≤ng ƒë√≥ v·ªÅ tr·∫°ng th√°i tr·ªëng (null).</p>
                
                <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-4">
                    <select id="resetRoundSelector" class="text-input w-full md:w-1/2 p-2 rounded-md">
                        <option value="">-- Ch·ªçn V√≤ng ƒê·∫•u --</option>
                        <option value="A">V√≤ng B·∫£ng A</option>
                        <option value="B">V√≤ng B·∫£ng B</option>
                        <option value="C">V√≤ng B·∫£ng C</option>
                        <option value="D">V√≤ng B·∫£ng D</option>
                        <option value="QF">T·ª© K·∫øt (QF)</option>
                        <option value="SF">B√°n K·∫øt (SF)</option>
                        <option value="F">Chung K·∫øt (F)</option>
                    </select>
                    
                    <button onclick="confirmResetScores()" class="w-full md:w-auto px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-lg transition duration-300 disabled:opacity-50">
                        X√ìA T·ªà S·ªê ƒê√É CH·ªåN
                    </button>
                </div>
                <div id="resetResult" class="mt-3 p-3 rounded-lg text-sm font-semibold hidden"></div>
            </section>
            
            <section class="p-4 bg-[var(--match-bg)] rounded-lg border-l-4 border-yellow-500">
                 <h3 class="text-xl font-bold text-[var(--group-header-text)] mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                    5. T√πy Ch·ªçn Giao Di·ªán & ƒê·ªìng B·ªô L·∫°i
                </h3>
                <p class="text-[var(--text-color)] mb-4">B·∫°n c√≥ th·ªÉ chuy·ªÉn ƒë·ªïi gi·ªØa giao di·ªán S√°ng/T·ªëi ho·∫∑c t·∫£i l·∫°i tr·∫°ng th√°i online m·ªõi nh·∫•t.</p>
                <button onclick="document.getElementById('themeToggle').click()" class="md:w-auto px-6 py-2 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg shadow-lg transition duration-300 mr-4">
                    Chuy·ªÉn ƒê·ªïi Giao Di·ªán (Hi·ªán t·∫°i: <span id="currentThemeDisplay">T·ªëi</span>)
                </button>
                <button id="reSyncButton" onclick="showConfirmationModal()" class="md:w-auto px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                    ƒê·ªìng B·ªô L·∫°i (T·∫£i l·∫°i t·ª´ GitHub)
                </button>
            </section>

        </div>

    </div>
    
    <div id="confirmationBox" class="modal-backdrop hidden">
        <div class="bg-[var(--card-bg)] p-6 rounded-xl shadow-2xl w-11/12 max-w-sm border-t-4 border-red-500 text-[var(--text-color)]">
            <h4 class="text-xl font-bold text-red-400 mb-4">X√°c Nh·∫≠n ƒê·ªìng B·ªô L·∫°i</h4>
            <p class="text-[var(--text-color)] mb-6">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën **ƒê·ªíNG B·ªò L·∫†I** tr·∫°ng th√°i gi·∫£i ƒë·∫•u v·ªÅ d·ªØ li·ªáu m·ªõi nh·∫•t t·ª´ GitHub kh√¥ng? ƒêi·ªÅu n√†y s·∫Ω ghi ƒë√® tr·∫°ng th√°i ƒëang nh·∫≠p c·ª•c b·ªô!</p>
            <div class="flex justify-end space-x-4">
                <button id="confirmNo" class="px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition duration-150">H·ªßy b·ªè</button>
                <button id="confirmYes" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition duration-150">X√°c nh·∫≠n ƒê·ªìng b·ªô</button>
            </div>
        </div>
    </div>

    <script>
        
        // ==============================================================================================================
        // KH·ªêI C·∫§U H√åNH GITHUB API & D·ªÆ LI·ªÜU (Phi√™n b·∫£n V6.5 - FIX initializeApp)
        // ==============================================================================================================
        const GITHUB_REPO_OWNER = 'cqtin2024';
        const GITHUB_REPO_NAME = 'ITVTG';
        
        const SCORE_FILE_PATH = 'data/state41s.json'; 
        const SCORE_API_URL = `https://api.github.com/repos/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/contents/${SCORE_FILE_PATH}`;
        const DIFF_DATA_URL = `https://raw.githubusercontent.com/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/main/${SCORE_FILE_PATH}`;

        const BASE_FILE_PATH = 'data/state41.json'; 
        const BASE_API_URL = `https://api.github.com/repos/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/contents/${BASE_FILE_PATH}`;
        const STATIC_DATA_URL = `https://raw.githubusercontent.com/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/main/${BASE_FILE_PATH}`;

        const BRANCH = 'main';
        const HIGH_SCORE_LIMIT = 11; 

        let tournamentData = null; 
        let initialTournamentData = null; 
        let githubToken = ''; 
        let startX = 0; 
        let endX = 0;  
        const swipeThreshold = 75; 
        
        const jsonToBase64 = (json) => btoa(unescape(encodeURIComponent(JSON.stringify(json, null, 2))));
        
        // ==============================================================================================================
        // --- H√ÄM H·ªñ TR·ª¢ D·ªÆ LI·ªÜU ---
        // ==============================================================================================================

        function showStatus(message, type = 'info', elementId = 'statusMessage') { /* ... (Gi·ªØ nguy√™n) ... */ }
        function switchTab(tabId) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function applyTheme(theme) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function toggleTheme() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function getTeamInfo(teamID) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function getGroupRankedTeam(groupCode, rank) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function findMatchByCode(matchCode) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function showConfirmationModal() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function handleGesture() { /* ... (Gi·ªØ nguy√™n) ... */ }
        
        // ==============================================================================================================
        // üö© V6.5: H√ÄM API GITHUB (ƒê√£ l∆∞·ª£c b·ªè ƒë·ªÉ ng·∫Øn g·ªçn, n·ªôi dung gi·ªØ nguy√™n V6.4)
        // ==============================================================================================================
        
        async function fetchGitHubFile(url, isBaseFile = false) { /* ... (Gi·ªØ nguy√™n) ... */ }
        async function loadDataFromGitHub() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function saveToken() { /* ... (Gi·ªØ nguy√™n) ... */ }
        async function commitChangesToGitHub(filePath, content, commitMessage, isDelete = false) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function getMatchDiffData() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function getDiffData() { /* ... (Gi·ªØ nguy√™n) ... */ }
        async function commitScoreChangesToGitHub() { /* ... (Gi·ªØ nguy√™n) ... */ }
        window.reSyncStaticData = function() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function exportTournamentData() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function resetScores(round) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function confirmResetScores() { /* ... (Gi·ªØ nguy√™n) ... */ }
        
        // ==============================================================================================================
        // üö© V6.5: LOGIC T√çNH TO√ÅN & R√ÄNG BU·ªòC ƒêI·ªÇM S·ªê (Gi·ªØ nguy√™n V6.4)
        // ==============================================================================================================
        
        window.handleInputScore = function(inputElement, matchCode, teamSide) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function calculateWinnerLoser(match) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function calculateGroupStatsAndRanks() { /* ... (Gi·ªØ nguy√™n) ... */ }
        
        // ==============================================================================================================
        // üö© V6.5: LOGIC TEAM MANAGEMENT & DIFF (Gi·ªØ nguy√™n V6.4)
        // ==============================================================================================================

        window.saveTeamChangesToLocal = function() { /* ... (Gi·ªØ nguy√™n) ... */ }
        
        // ==============================================================================================================
        // üö© V6.5: LOGIC KNOCKOUT SEEDING & UI RENDERING (Gi·ªØ nguy√™n V6.4)
        // ==============================================================================================================
        
        window.seedKnockoutMatches = function() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function updateSemiFinalSeeding() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function renderFinalResults() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function renderTeamManagement() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function renderKnockoutMatches(roundCode) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function simulateScores(round) { /* ... (Gi·ªØ nguy√™n) ... */ }
        
        // ==============================================================================================================
        // üö© V6.5: RENDERING CORE (Gi·ªØ nguy√™n V6.4)
        // ==============================================================================================================

        function renderTeamList() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function renderGroupTables(groupCode) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function renderGroupMatches(groupCode) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function renderAllData() { /* ... (Gi·ªØ nguy√™n) ... */ }
        
        // ==============================================================================================================
        // üö© V6.5: KH·ªûI T·∫†O ·ª®NG D·ª§NG (FIXED - ƒê∆ØA H√ÄM RA GLOBAL SCOPE)
        // ==============================================================================================================
        
        // G·∫Øn h√†m initializeApp v√†o ƒë·ªëi t∆∞·ª£ng window ƒë·ªÉ n√≥ c√≥ th·ªÉ ƒë∆∞·ª£c truy c·∫≠p t·ª´ window.onload
        window.initializeApp = function() {
            // Load token v√† theme ƒë√£ l∆∞u
            githubToken = localStorage.getItem('githubToken') || '';
            const savedTheme = localStorage.getItem('theme') || 'dark'; 
            applyTheme(savedTheme);

            if (githubToken) {
                 document.getElementById('githubToken').value = '********';
            }

            // Event listeners for theme toggle
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);

            // Event listeners for swipe navigation (on the whole app container)
            document.getElementById('app').addEventListener('touchstart', (e) => {
                // Ignore if touching an input field
                if (e.target.closest('.score-input, .text-input')) return;
                startX = e.changedTouches[0].screenX;
            }, { passive: true });

            document.getElementById('app').addEventListener('touchend', (e) => {
                // Ignore if touching an input field
                if (e.target.closest('.score-input, .text-input')) return;
                endX = e.changedTouches[0].screenX;
                handleGesture();
            }, { passive: true });
            
            // Modal button setup
            document.getElementById('confirmYes').onclick = window.reSyncStaticData;
            document.getElementById('confirmNo').onclick = () => document.getElementById('confirmationBox').classList.add('hidden');

            loadDataFromGitHub();
        }

        window.onload = window.initializeApp; // G·ªçi h√†m qua window object
    </script>
</body>
</html>
