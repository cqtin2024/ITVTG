<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω Gi·∫£i ƒê·∫•u & C·∫≠p Nh·∫≠t Th√¥ng Tin (GitHub Sync) V6.4 - DEV</title> 
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;400;700;900&display=swap" rel="stylesheet">
    <style>
        /* Base styles for Dark Mode */
        :root {
            --bg-color: #111827; 
            --text-color: #f3f4f6; 
            --card-bg: #1f2937; 
            --border-color: #374151; 
            --accent-color: #06b6d4; 
            --match-bg: #1f2937;
            --input-bg: #4b5563; 
            --group-header-text: #60a5fa; 
        }
        
        /* Light Mode Overrides */
        .light-mode {
            --bg-color: #f9fafb; 
            --text-color: #111827; 
            --card-bg: #ffffff;
            --border-color: #e5e7eb; 
            --accent-color: #ef4444; 
            --match-bg: #f3f4f6; 
            --input-bg: #ffffff;
            --group-header-text: #10b981; 
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }
        .container {
            max-width: 1200px;
        }
        .score-input, .text-input {
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }
        .score-input:focus, .text-input:focus {
            box-shadow: 0 0 0 3px var(--accent-color);
        }
        .tab-button {
            border-bottom-color: var(--border-color);
        }
        .tab-button.active {
            color: var(--accent-color);
            border-color: var(--accent-color);
            background-color: var(--card-bg);
        }
        .tab-content {
            display: none;
            background-color: var(--card-bg);
            border-radius: 0.75rem; 
            padding: 1.5rem; 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); 
        }
        
        ::-webkit-scrollbar { height: 8px; }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6b7280; }
        
        .match-card {
            background-color: var(--match-bg);
            border-bottom: 1px solid var(--border-color);
        }
        .light-mode .match-card {
            background-color: #ffffff;
            border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="app" class="container mx-auto">
        <header class="flex items-center justify-between mb-6">
            <div class="flex items-center">
                <svg class="w-10 h-10 md:w-12 md:h-12 text-[var(--accent-color)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 15.75l-4-4m0 0l4-4m-4 4h14M17 12a5 5 0 11-10 0 5 5 0 0110 0z"></path></svg>
                <div class="text-left ml-4">
                    <h1 class="text-xl md:text-3xl font-extrabold text-[var(--text-color)] leading-none">QU·∫¢N L√ù GI·∫¢I ƒê·∫§U PICKLEBALL (V6.4)</h1>
                    <p class="text-xs md:text-sm text-[var(--accent-color)]">C·∫≠p Nh·∫≠t T·ªâ S·ªë & Th√¥ng Tin ƒê·ªôi (GitHub Sync)</p>
                </div>
            </div>
            
            <button id="themeToggle" onclick="toggleTheme()" class="p-3 rounded-full bg-[var(--card-bg)] shadow-md text-[var(--text-color)] hover:bg-[var(--border-color)] transition duration-200">
                <svg id="sunIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                <svg id="moonIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
            </button>
        </header>

        <div id="statusMessage" class="text-center p-4 bg-blue-900/50 rounded-lg text-blue-300 font-semibold mb-6">
            ƒêang t·∫£i d·ªØ li·ªáu tr·∫°ng th√°i t·ª´ GitHub...
        </div>
        
        <nav class="mb-8 border-b border-[var(--border-color)] overflow-x-auto whitespace-nowrap">
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('General')" data-tab="General">General</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('TeamManagement')" data-tab="TeamManagement">Qu·∫£n L√Ω ƒê·ªôi</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('GroupA')" data-tab="GroupA">Group A</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('GroupB')" data-tab="GroupB">Group B</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('GroupC')" data-tab="GroupC">Group C</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('GroupD')" data-tab="GroupD">Group D</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('Knockout')" data-tab="Knockout">Knockout</button>
            <button class="tab-button py-3 px-4 md:px-6 text-sm md:text-base font-semibold border-b-2 border-transparent text-gray-400 hover:text-[var(--accent-color)] transition" onclick="switchTab('Configuration')" data-tab="Configuration">C·∫•u H√¨nh</button>
        </nav>

        <div id="General" class="tab-content">
             <h2 class="text-3xl font-extrabold text-yellow-500 mb-6 border-b border-[var(--border-color)] pb-2">Final Results (K·∫øt qu·∫£ chung cu·ªôc)</h2>
            <section id="finalResults" class="mb-10 p-4 rounded-xl shadow-lg bg-[var(--match-bg)]">
                <div id="championDisplay" class="text-center">
                    <p class="text-4xl font-black text-yellow-500 mb-2">Ch∆∞a x√°c ƒë·ªãnh</p>
                    <p class="text-lg text-yellow-500">Nh√† V√¥ ƒê·ªãch Gi·∫£i ƒê·∫•u</p>
                </div>
                 <div id="runnerUpDisplay" class="text-center mt-4 border-t border-[var(--border-color)] pt-4">
                    <p class="text-2xl font-bold text-gray-400 mb-1">Ch∆∞a x√°c ƒë·ªãnh</p>
                    <p class="text-md text-gray-400">√Å Qu√¢n Gi·∫£i ƒê·∫•u</p>
                </div>
            </section>

            <h2 class="text-3xl font-extrabold text-[var(--text-color)] mb-6 border-b border-[var(--border-color)] pb-2">Team List (Danh s√°ch c√°c ƒë·ªôi)</h2>
            <section id="teamList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                </section>
        </div>
        
        <div id="TeamManagement" class="tab-content">
            <h2 class="text-3xl font-extrabold text-blue-500 mb-6 border-b border-[var(--border-color)] pb-2">Qu·∫£n L√Ω Th√¥ng Tin ƒê·ªôi (L∆∞u c·ª•c b·ªô)</h2>
            <p class="text-sm text-gray-400 mb-4">ƒêi·ªÅu ch·ªânh **T√™n ƒë·ªôi (Tn)**, **T√™n ng∆∞·ªùi ch∆°i (name)**, **C·∫•p ƒë·ªô (pL)**, v√† **NƒÉm sinh (bY)**. C√°c thay ƒë·ªïi n√†y ch·ªâ ƒë∆∞·ª£c l∆∞u c·ª•c b·ªô v√† **ch·ªâ ƒë∆∞·ª£c ƒë·ªìng b·ªô l√™n GitHub khi b·∫°n COMMIT T·ªà S·ªê** (s·ª≠ d·ª•ng file `state41s.json`).</p>
            
            <button id="saveTeamLocalButton" onclick="saveTeamChangesToLocal()" class="w-full md:w-auto px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-lg transition duration-300 mb-6">
                L∆ØU C√ÅC THAY ƒê·ªîI ƒê·ªòI C·ª§C B·ªò (Kh√¥ng Commit)
            </button>
            
            <div id="teamCommitResult" class="mt-3 p-3 rounded-lg text-sm font-semibold hidden"></div>

            <section id="teamManagementList" class="space-y-6"></section>
        </div>


        <div id="GroupA" class="tab-content space-y-6">
            <button onclick="simulateScores('A')" class="w-full md:w-auto px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                GI·∫¢ L·∫¨P T·ªà S·ªê V√íNG B·∫¢NG A
            </button>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div id="tableA" class="lg:col-span-1"></div>
                <div id="matchesA" class="lg:col-span-2"></div>
            </div>
        </div>

        <div id="GroupB" class="tab-content space-y-6">
            <button onclick="simulateScores('B')" class="w-full md:w-auto px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                GI·∫¢ L·∫¨P T·ªà S·ªê V√íNG B·∫¢NG B
            </button>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div id="tableB" class="lg:col-span-1"></div>
                <div id="matchesB" class="lg:col-span-2"></div>
            </div>
        </div>

        <div id="GroupC" class="tab-content space-y-6">
             <button onclick="simulateScores('C')" class="w-full md:w-auto px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                GI·∫¢ L·∫¨P T·ªà S·ªê V√íNG B·∫¢NG C
            </button>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div id="tableC" class="lg:col-span-1"></div>
                <div id="matchesC" class="lg:col-span-2"></div>
            </div>
        </div>

        <div id="GroupD" class="tab-content space-y-6">
             <button onclick="simulateScores('D')" class="w-full md:w-auto px-6 py-2 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                GI·∫¢ L·∫¨P T·ªà S·ªê V√íNG B·∫¢NG D
            </button>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div id="tableD" class="lg:col-span-1"></div>
                <div id="matchesD" class="lg:col-span-2"></div>
            </div>
        </div>

        <div id="Knockout" class="tab-content">
            <h2 class="text-3xl font-extrabold text-[var(--group-header-text)] mb-6 border-b border-[var(--border-color)] pb-2">V√≤ng Lo·∫°i Tr·ª±c Ti·∫øp (Knockout Stage)</h2>
            <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-4 mb-6">
                <button onclick="seedKnockoutMatches()" id="seedButton" class="w-full md:w-auto px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-lg transition duration-300 disabled:opacity-50">
                    T·ª∞ ƒê·ªòNG X·∫æP C·∫∂P T·ª® K·∫æT (SEEDING)
                </button>
                <button onclick="simulateScores('Knockout')" class="w-full md:w-auto px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                    GI·∫¢ L·∫¨P T·ªà S·ªê V√íNG LO·∫†I (QF, SF, F)
                </button>
            </div>
            
            <div id="seedingStatus" class="p-3 bg-blue-900/30 text-blue-300 rounded-lg mb-6">
                Tr·∫°ng th√°i Seeding: Ch∆∞a kh·ªüi t·∫°o T·ª© k·∫øt.
            </div>
            
            <div id="quarterfinals" class="mb-6"></div>
            <div id="semifinals" class="mb-6"></div>
            <div id="finalMatchSection">
                <div id="finalSection"></div>
            </div>
        </div>

        <div id="Configuration" class="tab-content space-y-8">
            <h2 class="text-3xl font-extrabold text-red-500 mb-6 border-b border-[var(--border-color)] pb-2">C·∫•u H√¨nh & ƒê·ªìng B·ªô H√≥a (GitHub API)</h2>
            
             <section class="p-4 bg-red-900/20 rounded-lg border-l-4 border-red-500">
                <h3 class="text-xl font-bold text-red-400 mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                    1. GitHub Personal Access Token (PAT)
                </h3>
                <p class="text-sm text-red-300 mb-4 font-bold">C·∫¢NH B√ÅO B·∫¢O M·∫¨T: Token n√†y s·∫Ω ƒë∆∞·ª£c l∆∞u tr·ªØ trong tr√¨nh duy·ªát. Ch·ªâ s·ª≠ d·ª•ng Token c√≥ ph·∫°m vi (Scope) nh·ªè nh·∫•t. <span class="text-yellow-300">C·∫¶N PH·∫¢I C√ì QUY·ªÄN **repo** (ho·∫∑c contents:write)</span>.</p>
                <input type="password" id="githubToken" 
                    class="score-input w-full p-2 rounded-md focus:ring-red-500 transition" 
                    placeholder="D√°n GitHub PAT c·ªßa b·∫°n v√†o ƒë√¢y...">
                <button onclick="saveToken()" class="mt-2 px-4 py-1 bg-green-600 hover:bg-green-700 text-white text-sm font-bold rounded-lg transition duration-300">L∆∞u Token c·ª•c b·ªô</button>
            </section>

            <section class="p-4 bg-[var(--match-bg)] rounded-lg border-l-4 border-purple-500">
                <h3 class="text-xl font-bold text-[var(--group-header-text)] mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                    2. C·∫≠p Nh·∫≠t T·ªâ S·ªë (Commit) l√™n **state41s.json**
                </h3>
                <p class="text-gray-400 mb-4">S·ª≠ d·ª•ng Token ƒë√£ l∆∞u ƒë·ªÉ commit nh·ªØng t·ªâ s·ªë v√† th√¥ng tin ƒë·ªôi **ƒë√£ thay ƒë·ªïi** l√™n GitHub (file `state41s.json`).</p>
                
                <button id="commitScoreButton" onclick="commitScoreChangesToGitHub()" class="w-full md:w-auto px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-lg shadow-lg transition duration-300 mb-4 disabled:opacity-50">
                    COMMIT T·ªà S·ªê & THAY ƒê·ªîI ƒê·ªòI
                </button>

                <div id="scoreCommitResult" class="mt-3 p-3 rounded-lg text-sm font-semibold hidden"></div>
            </section>
            
             <section class="p-4 bg-[var(--match-bg)] rounded-lg border-l-4 border-green-500">
                 <h3 class="text-xl font-bold text-[var(--group-header-text)] mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                    3. Xu·∫•t D·ªØ Li·ªáu Gi·∫£i ƒê·∫•u (state41.json Format)
                </h3>
                <p class="text-[var(--text-color)] mb-4">T·∫°o v√† t·∫£i v·ªÅ file JSON ch·ª©a to√†n b·ªô tr·∫°ng th√°i gi·∫£i ƒë·∫•u hi·ªán t·∫°i, bao g·ªìm th√¥ng tin ƒë·ªôi v√† t·ªâ s·ªë ƒë√£ t√≠nh to√°n.</p>
                <button onclick="exportTournamentData()" class="md:w-auto px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                    T·∫¢I XU·ªêNG TO√ÄN B·ªò JSON
                </button>
                <div id="configExportResult" class="mt-3 p-3 rounded-lg text-sm font-semibold hidden"></div>
            </section>
            
            <section class="p-4 bg-[var(--match-bg)] rounded-lg border-l-4 border-red-500">
                <h3 class="text-xl font-bold text-red-400 mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                    4. X√≥a (Reset) T·ªâ S·ªë Tr·∫≠n ƒê·∫•u
                </h3>
                <p class="text-gray-400 mb-4">Ch·ªçn v√≤ng ƒë·∫•u v√† nh·∫•n n√∫t ƒë·ªÉ **X√ìA T·∫§T C·∫¢** t·ªâ s·ªë ƒë√£ nh·∫≠p trong v√≤ng ƒë√≥ v·ªÅ tr·∫°ng th√°i tr·ªëng (null).</p>
                
                <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-4">
                    <select id="resetRoundSelector" class="text-input w-full md:w-1/2 p-2 rounded-md">
                        <option value="">-- Ch·ªçn V√≤ng ƒê·∫•u --</option>
                        <option value="A">V√≤ng B·∫£ng A</option>
                        <option value="B">V√≤ng B·∫£ng B</option>
                        <option value="C">V√≤ng B·∫£ng C</option>
                        <option value="D">V√≤ng B·∫£ng D</option>
                        <option value="QF">T·ª© K·∫øt (QF)</option>
                        <option value="SF">B√°n K·∫øt (SF)</option>
                        <option value="F">Chung K·∫øt (F)</option>
                    </select>
                    
                    <button onclick="confirmResetScores()" class="w-full md:w-auto px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-lg transition duration-300 disabled:opacity-50">
                        X√ìA T·ªà S·ªê ƒê√É CH·ªåN
                    </button>
                </div>
                <div id="resetResult" class="mt-3 p-3 rounded-lg text-sm font-semibold hidden"></div>
            </section>
            
            <section class="p-4 bg-[var(--match-bg)] rounded-lg border-l-4 border-yellow-500">
                 <h3 class="text-xl font-bold text-[var(--group-header-text)] mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                    5. T√πy Ch·ªçn Giao Di·ªán & ƒê·ªìng B·ªô L·∫°i
                </h3>
                <p class="text-[var(--text-color)] mb-4">B·∫°n c√≥ th·ªÉ chuy·ªÉn ƒë·ªïi gi·ªØa giao di·ªán S√°ng/T·ªëi ho·∫∑c t·∫£i l·∫°i tr·∫°ng th√°i online m·ªõi nh·∫•t.</p>
                <button onclick="document.getElementById('themeToggle').click()" class="md:w-auto px-6 py-2 bg-yellow-500 hover:bg-yellow-600 text-black font-bold rounded-lg shadow-lg transition duration-300 mr-4">
                    Chuy·ªÉn ƒê·ªïi Giao Di·ªán (Hi·ªán t·∫°i: <span id="currentThemeDisplay">T·ªëi</span>)
                </button>
                <button id="reSyncButton" onclick="showConfirmationModal()" class="md:w-auto px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-lg transition duration-300">
                    ƒê·ªìng B·ªô L·∫°i (T·∫£i l·∫°i t·ª´ GitHub)
                </button>
            </section>

        </div>

    </div>
    
    <div id="confirmationBox" class="modal-backdrop hidden">
        <div class="bg-[var(--card-bg)] p-6 rounded-xl shadow-2xl w-11/12 max-w-sm border-t-4 border-red-500 text-[var(--text-color)]">
            <h4 class="text-xl font-bold text-red-400 mb-4">X√°c Nh·∫≠n ƒê·ªìng B·ªô L·∫°i</h4>
            <p class="text-[var(--text-color)] mb-6">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën **ƒê·ªíNG B·ªò L·∫†I** tr·∫°ng th√°i gi·∫£i ƒë·∫•u v·ªÅ d·ªØ li·ªáu m·ªõi nh·∫•t t·ª´ GitHub kh√¥ng? ƒêi·ªÅu n√†y s·∫Ω ghi ƒë√® tr·∫°ng th√°i ƒëang nh·∫≠p c·ª•c b·ªô!</p>
            <div class="flex justify-end space-x-4">
                <button id="confirmNo" class="px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition duration-150">H·ªßy b·ªè</button>
                <button id="confirmYes" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition duration-150">X√°c nh·∫≠n ƒê·ªìng b·ªô</button>
            </div>
        </div>
    </div>

    <script>
        
        // ==============================================================================================================
        // KH·ªêI C·∫§U H√åNH GITHUB API & D·ªÆ LI·ªÜU (Phi√™n b·∫£n V6.4)
        // ==============================================================================================================
        const GITHUB_REPO_OWNER = 'cqtin2024';
        const GITHUB_REPO_NAME = 'ITVTG';
        
        const SCORE_FILE_PATH = 'data/state41s.json'; 
        const SCORE_API_URL = `https://api.github.com/repos/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/contents/${SCORE_FILE_PATH}`;
        const DIFF_DATA_URL = `https://raw.githubusercontent.com/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/main/${SCORE_FILE_PATH}`;

        const BASE_FILE_PATH = 'data/state41.json'; 
        const BASE_API_URL = `https://api.github.com/repos/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/contents/${BASE_FILE_PATH}`;
        const STATIC_DATA_URL = `https://raw.githubusercontent.com/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}/main/${BASE_FILE_PATH}`;

        const BRANCH = 'main';
        const HIGH_SCORE_LIMIT = 11; // üö© LU·∫¨T M·ªöI V6.4: ƒêi·ªÉm t·ªëi ƒëa ƒë·ªÉ th·∫Øng m·ªôt tr·∫≠n ƒë·∫•u.

        let tournamentData = null; 
        let initialTournamentData = null; 
        let githubToken = ''; 
        let startX = 0; 
        let endX = 0;  
        const swipeThreshold = 75; 
        
        const jsonToBase64 = (json) => btoa(unescape(encodeURIComponent(JSON.stringify(json, null, 2))));
        
        // ==============================================================================================================
        // --- H√ÄM H·ªñ TR·ª¢ D·ªÆ LI·ªÜU ---
        // ==============================================================================================================

        function showStatus(message, type = 'info', elementId = 'statusMessage') { /* ... (Gi·ªØ nguy√™n) ... */ }
        function switchTab(tabId) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function applyTheme(theme) { /* ... (Gi·ªØ nguy√™n) ... */ }
        function toggleTheme() { /* ... (Gi·ªØ nguy√™n) ... */ }
        function getTeamInfo(teamID) {
            if (!tournamentData || !tournamentData.tL || !teamID) return { Tn: teamID, T: teamID, W: 0, L: 0, Pts: 0, gR: 0, P: [] };
            
            const team = tournamentData.tL.find(t => t.T === teamID);
            
            return team || { Tn: teamID, T: teamID, W: 0, L: 0, Pts: 0, gR: 0, P: [] }; 
        }

        function findMatchByCode(matchCode) {
            if (!tournamentData) return null;
            const rounds = ['matchesA', 'matchesB', 'matchesC', 'matchesD', 'quarterfinals', 'semifinals'];
            for (const round of rounds) {
                if (tournamentData[round]) {
                    const match = tournamentData[round].find(m => m.Mc === matchCode);
                    if (match) return match;
                }
            }
            if (tournamentData.final && tournamentData.final.Mc === matchCode) {
                return tournamentData.final;
            }
            return null;
        }

        // ==============================================================================================================
        // üö© V6.4: LOGIC T√çNH TO√ÅN & R√ÄNG BU·ªòC ƒêI·ªÇM S·ªê
        // ==============================================================================================================
        
        /** V6.4: √Åp d·ª•ng r√†ng bu·ªôc HS v√† t√≠nh to√°n Wn/rU */
        window.handleInputScore = function(inputElement, matchCode, teamSide) {
            const value = parseInt(inputElement.value);
            
            // 1. R√†ng bu·ªôc c∆° b·∫£n
            if (isNaN(value) || value < 0) {
                inputElement.value = '';
                return; 
            }
            
            let match = findMatchByCode(matchCode);
            if (!match) return;

            // C·∫≠p nh·∫≠t gi√° tr·ªã v√†o tournamentData c·ª•c b·ªô
            if (teamSide === 'A') {
                match.sA = value;
            } else {
                match.sB = value;
            }

            // 2. R√ÄNG BU·ªòC LU·∫¨T HS KHI C·∫¢ HAI T·ªà S·ªê ƒê√É ƒê∆Ø·ª¢C NH·∫¨P
            if (match.sA !== null && match.sB !== null) {
                const scoreA = match.sA;
                const scoreB = match.sB;
                
                // Tr·∫≠n ƒë·∫•u ch∆∞a ho√†n th√†nh (Ch∆∞a ƒë·∫°t t·ªõi ƒëi·ªÉm th·∫Øng tuy·ªát ƒë·ªëi)
                if (scoreA < HIGH_SCORE_LIMIT && scoreB < HIGH_SCORE_LIMIT) {
                    // Cho ph√©p nh·∫≠p ti·∫øp, nh∆∞ng c·∫£nh b√°o n·∫øu m·ªôt b√™n ƒë√£ ƒë·∫°t HS
                    if (scoreA > scoreB && scoreA === HIGH_SCORE_LIMIT - 1 && scoreB < HIGH_SCORE_LIMIT - 1) {
                         // C·∫£nh b√°o: T·ªâ s·ªë ƒëang s√°t n√∫t
                    }
                } 
                // Tr·∫≠n ƒë·∫•u ƒë√£ ho√†n th√†nh (M·ªôt b√™n ƒë·∫°t HS)
                else {
                    const winnerScore = Math.max(scoreA, scoreB);
                    const loserScore = Math.min(scoreA, scoreB);
                    
                    // R√†ng bu·ªôc 1: ƒê·ªôi th·∫Øng ph·∫£i l√† HS
                    if (winnerScore !== HIGH_SCORE_LIMIT) {
                         showStatus(`Theo lu·∫≠t HS=${HIGH_SCORE_LIMIT}, t·ªâ s·ªë ƒë·ªôi th·∫Øng ph·∫£i l√† ${HIGH_SCORE_LIMIT}. ƒêang t·ª± ƒë·ªông ch·ªânh th√†nh ${HIGH_SCORE_LIMIT}.`, 'warning', 'statusMessage');
                         
                         // T·ª± ƒë·ªông ch·ªânh t·ªâ s·ªë ƒë·ªôi th·∫Øng v·ªÅ HS
                         if (scoreA > scoreB) { match.sA = HIGH_SCORE_LIMIT; inputElement.value = HIGH_SCORE_LIMIT; }
                         else { match.sB = HIGH_SCORE_LIMIT; inputElement.value = HIGH_SCORE_LIMIT; }
                         
                    }
                    
                    // R√†ng bu·ªôc 2: ƒê·ªôi thua ph·∫£i l√† < HS
                    if (loserScore >= HIGH_SCORE_LIMIT) {
                         showStatus(`L·ªói logic: ƒê·ªôi thua kh√¥ng th·ªÉ ƒë·∫°t t·ªâ s·ªë ${HIGH_SCORE_LIMIT} ho·∫∑c h∆°n khi tr·∫≠n ƒë·∫•u k·∫øt th√∫c. ƒê√£ reset t·ªâ s·ªë.`, 'error', 'statusMessage');
                         // Reset t·ªâ s·ªë
                         match.sA = null; match.sB = null;
                         document.getElementById(`score-input-${match.Mc}-A`).value = '';
                         document.getElementById(`score-input-${match.Mc}-B`).value = '';
                         return; // D·ª´ng x·ª≠ l√Ω
                    }
                }
            }

            // 3. T√≠nh to√°n l·∫°i Wn, th·ªëng k√™, v√† render UI
            calculateWinnerLoser(match);
            renderAllData(); 
            showStatus('T·ªâ s·ªë ƒë√£ ƒë∆∞·ª£c l∆∞u c·ª•c b·ªô. Vui l√≤ng COMMIT (Tab C·∫•u h√¨nh) ƒë·ªÉ ƒë·ªìng b·ªô l√™n GitHub.', 'info', 'statusMessage');
        };

        /** V6.3: C·∫≠p nh·∫≠t Wn (Winner) v√† rU (Runner-Up) */
        function calculateWinnerLoser(match) {
            if (match.sA === null || match.sB === null || (match.sA === 0 && match.sB === 0)) {
                match.Wn = "";
                if (match.Mc === 'F') match.rU = "";
                return;
            }

            const scoreA = match.sA;
            const scoreB = match.sB;
            
            if (scoreA > scoreB) {
                match.Wn = match.A;
                if (match.Mc === 'F') match.rU = match.B;
            } else if (scoreB > scoreA) {
                match.Wn = match.B;
                if (match.Mc === 'F') match.rU = match.A;
            } else {
                match.Wn = "";
                if (match.Mc === 'F') match.rU = "";
            }
        }
        
        /** V6.4: T√≠nh to√°n l·∫°i W, L, Pts v√† gR (Group Rank) cho t·∫•t c·∫£ c√°c ƒë·ªôi. */
        function calculateGroupStatsAndRanks() {
            if (!tournamentData || !tournamentData.tL) return;
            
            // 1. Reset th·ªëng k√™ cho t·∫•t c·∫£ ƒë·ªôi
            tournamentData.tL.forEach(team => {
                team.W = 0;
                team.L = 0;
                team.Pts = 0;
                team.mP = 0; 
                team.gR = 0; // Reset Rank
            });

            // 2. L·∫∑p qua t·∫•t c·∫£ c√°c tr·∫≠n ƒë·∫•u V√≤ng B·∫£ng ƒë·ªÉ t√≠nh W, L, Pts
            const groupMatches = [...(tournamentData.matchesA || []), ...(tournamentData.matchesB || []), ...(tournamentData.matchesC || []), ...(tournamentData.matchesD || [])];
            
            groupMatches.forEach(match => {
                if (match.Wn) { // Ch·ªâ t√≠nh to√°n n·∫øu tr·∫≠n ƒë·∫•u ƒë√£ c√≥ ng∆∞·ªùi th·∫Øng
                    const winnerTeam = tournamentData.tL.find(t => t.T === match.Wn);
                    const loserTeamCode = match.Wn === match.A ? match.B : match.A;
                    const loserTeam = tournamentData.tL.find(t => t.T === loserTeamCode);
                    
                    if (winnerTeam) {
                        winnerTeam.W += 1;
                        winnerTeam.Pts += 3; // Gi·∫£ ƒë·ªãnh 3 ƒëi·ªÉm cho tr·∫≠n th·∫Øng
                        winnerTeam.mP += 1;
                    }
                    if (loserTeam) {
                        loserTeam.L += 1;
                        loserTeam.mP += 1;
                    }
                }
            });

            // 3. T√≠nh to√°n gR (Group Rank) cho t·ª´ng nh√≥m
            const groupCodes = ['A', 'B', 'C', 'D'];
            groupCodes.forEach(code => {
                let groupTeams = tournamentData.tL.filter(t => t.g === code && t.mP > 0); // Ch·ªâ x·∫øp h·∫°ng ƒë·ªôi ƒë√£ thi ƒë·∫•u
                
                // S·∫Øp x·∫øp theo ti√™u ch√≠: Pts (cao nh·∫•t), W (cao nh·∫•t), L (th·∫•p nh·∫•t)
                groupTeams.sort((a, b) => {
                    if ((b.Pts || 0) !== (a.Pts || 0)) return (b.Pts || 0) - (a.Pts || 0); // 1. Points
                    if ((b.W || 0) !== (a.W || 0)) return (b.W || 0) - (a.W || 0); // 2. Wins
                    return (a.L || 0) - (b.L || 0); // 3. Losses
                });
                
                // G√°n gR
                groupTeams.forEach((team, index) => {
                    team.gR = index + 1;
                });
            });
        }

        // ==============================================================================================================
        // üö© V6.4: LOGIC TEAM MANAGEMENT & DIFF
        // ==============================================================================================================

        /**
         * V6.4: L∆∞u c√°c thay ƒë·ªïi v·ªÅ th√¥ng tin ƒë·ªôi (Tn, name, pL, bY) v√†o bi·∫øn tournamentData c·ª•c b·ªô.
         */
        window.saveTeamChangesToLocal = function() {
            if (!tournamentData || !tournamentData.tL) {
                showStatus('L·ªói: Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ l∆∞u.', 'error', 'teamCommitResult');
                return;
            }
            
            let changesDetected = false;
            
            tournamentData.tL.forEach(team => {
                // C·∫≠p nh·∫≠t Nickname (Tn)
                const tnInput = document.getElementById(`team-tn-${team.T}`);
                if (tnInput && tnInput.value !== team.Tn) {
                    team.Tn = tnInput.value;
                    changesDetected = true;
                }

                // C·∫≠p nh·∫≠t th√¥ng tin Ng∆∞·ªùi ch∆°i (name, pL, bY)
                team.P.forEach((player, index) => {
                    const nameInput = document.getElementById(`player-name-${team.T}-${index}`);
                    const pLInput = document.getElementById(`player-pl-${team.T}-${index}`);
                    const bYInput = document.getElementById(`player-by-${team.T}-${index}`);

                    if (nameInput && nameInput.value !== player.name) {
                        player.name = nameInput.value;
                        changesDetected = true;
                    }
                    // pL c·∫ßn ƒë∆∞·ª£c parse th√†nh float
                    if (pLInput && parseFloat(pLInput.value) !== player.pL) {
                        player.pL = parseFloat(pLInput.value);
                        changesDetected = true;
                    }
                    if (bYInput && bYInput.value !== player.bY) {
                        player.bY = bYInput.value;
                        changesDetected = true;
                    }
                });
            });
            
            if (changesDetected) {
                renderAllData(); 
                showStatus('ƒê√£ l∆∞u c√°c thay ƒë·ªïi ƒë·ªôi C·ª§C B·ªò v√†o b·ªô nh·ªõ tr√¨nh duy·ªát. Vui l√≤ng COMMIT T·ªà S·ªê (Tab C·∫•u h√¨nh) ƒë·ªÉ ƒë·ªìng b·ªô l√™n GitHub.', 'success', 'teamCommitResult');
            } else {
                showStatus('Kh√¥ng c√≥ thay ƒë·ªïi n√†o ƒë∆∞·ª£c ph√°t hi·ªán ƒë·ªÉ l∆∞u.', 'info', 'teamCommitResult');
            }
        }
        
        /**
         * V6.4: L·ªçc ra nh·ªØng thay ƒë·ªïi (diff) (t·ªâ s·ªë + team info) gi·ªØa d·ªØ li·ªáu hi·ªán t·∫°i v√† d·ªØ li·ªáu kh·ªüi t·∫°o.
         */
        function getDiffData() {
             if (!tournamentData || !initialTournamentData) return null;

             let diff = {};
             let diffFound = false;
             
             // 1. So s√°nh T·ªâ s·ªë (sA, sB) trong c√°c tr·∫≠n ƒë·∫•u (Matches Diff)
             // [Logic so s√°nh t·ªâ s·ªë (ƒë√£ c√≥) - Gi·ªØ nguy√™n]

             // 2. So s√°nh th√¥ng tin ƒë·ªôi (tL Diff) - LOGIC M·ªöI V6.4
             const teamDiff = [];
             tournamentData.tL.forEach((currentTeam, index) => {
                 const initialTeam = initialTournamentData.tL[index];

                 // So s√°nh c√°c tr∆∞·ªùng c√≥ th·ªÉ ch·ªânh s·ª≠a: Tn, P
                 // D√πng JSON.stringify ƒë·ªÉ so s√°nh m·∫£ng P
                 if (currentTeam.Tn !== initialTeam.Tn || JSON.stringify(currentTeam.P) !== JSON.stringify(initialTeam.P)) {
                     // Ch·ªâ th√™m c√°c tr∆∞·ªùng c·∫ßn thi·∫øt ƒë·ªÉ c·∫≠p nh·∫≠t l√™n state41s.json
                     teamDiff.push({ 
                         T: currentTeam.T,
                         Tn: currentTeam.Tn,
                         P: currentTeam.P,
                         gR: currentTeam.gR,
                     });
                     diffFound = true;
                 }
             });

             if (teamDiff.length > 0) {
                 diff.tL = teamDiff;
             }
             
             // G·ªôp t·∫•t c·∫£ diff (t·ªâ s·ªë v√† team) v√†o ƒë·ªëi t∆∞·ª£ng diff v√† tr·∫£ v·ªÅ
             if (diffFound || (diff.matchesA || diff.matchesB || diff.matchesC || diff.matchesD || diff.quarterfinals || diff.semifinals || diff.final)) {
                  // ... (Logic g√°n l·∫°i matchesDiff v√†o diff)
                  return diff;
             }

             return null;
        }


        // ==============================================================================================================
        // üö© V6.4: LOGIC KNOCKOUT SEEDING & UI RENDERING
        // ==============================================================================================================
        
        /**
         * V6.4: T·ª± ƒë·ªông ƒëi·ªÅn c√°c c·∫∑p T·ª© K·∫øt (Quarterfinals) d·ª±a tr√™n lu·∫≠t Seeding.
         */
        window.seedKnockoutMatches = function() {
            if (!tournamentData || !tournamentData.tL) {
                 return showStatus('L·ªói: Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªôi ƒë·ªÉ Seeding.', 'error', 'seedingStatus');
            }

            // Lu·∫≠t Seeding m·∫∑c ƒë·ªãnh: 1A vs 2B, 1C vs 2D, 1B vs 2A, 1D vs 2C
            const seedingOrder = [
                { Mc: 'QF1', A_Group: 'A', A_Rank: 1, B_Group: 'B', B_Rank: 2 }, 
                { Mc: 'QF2', A_Group: 'C', A_Rank: 1, B_Group: 'D', B_Rank: 2 }, 
                { Mc: 'QF3', A_Group: 'B', A_Rank: 1, B_Group: 'A', B_Rank: 2 }, 
                { Mc: 'QF4', A_Group: 'D', A_Rank: 1, B_Group: 'C', B_Rank: 2 }  
            ];
            
            // ... (Logic kh·ªüi t·∫°o tournamentData.quarterfinals n·∫øu c·∫ßn) ...
            
            let allTeamsFound = true;
            let seededCount = 0;
            
            seedingOrder.forEach(seed => {
                const teamA = getTeamInfo(getGroupRankedTeam(seed.A_Group, seed.A_Rank)); // L·∫•y Team ID
                const teamB = getTeamInfo(getGroupRankedTeam(seed.B_Group, seed.B_Rank)); // L·∫•y Team ID

                if (teamA.T && teamB.T) {
                    const qfMatch = tournamentData.quarterfinals.find(m => m.Mc === seed.Mc);
                    if (qfMatch) {
                        qfMatch.A = teamA.T;
                        qfMatch.B = teamB.T;
                        seededCount++;
                    }
                } else {
                    allTeamsFound = false;
                }
            });

            if (allTeamsFound) {
                showStatus(`X·∫æP C·∫∂P T·ª® K·∫æT TH√ÄNH C√îNG: ƒê√£ ƒëi·ªÅn ${seededCount} c·∫∑p ƒë·∫•u. Vui l√≤ng COMMIT TH√îNG TIN ƒê·ªòI ƒë·ªÉ l∆∞u thay ƒë·ªïi n√†y v√†o BASE file.`, 'success', 'seedingStatus');
            } else {
                 showStatus(`X·∫æP C·∫∂P T·ª® K·∫æT CH∆ØA HO√ÄN TH√ÄNH: Thi·∫øu ƒë·ªôi x·∫øp h·∫°ng (gR) t·ª´ m·ªôt ho·∫∑c nhi·ªÅu B·∫£ng ƒë·∫•u. C·∫ßn ho√†n th√†nh t·ªâ s·ªë V√≤ng B·∫£ng v√† t√≠nh to√°n l·∫°i x·∫øp h·∫°ng tr∆∞·ªõc.`, 'warning', 'seedingStatus');
            }
            
            updateSemiFinalSeeding(); 
            renderAllData();
        }

        /** V6.4: C·∫≠p nh·∫≠t c·∫∑p B√°n k·∫øt (SF) v√† Chung k·∫øt (F) */
        function updateSemiFinalSeeding() {
             // ... (Logic gi·ªØ nguy√™n, ƒë·∫£m b·∫£o c·∫≠p nh·∫≠t Wn/rU t·ª´ c√°c v√≤ng tr∆∞·ªõc) ...
        }

        // ==============================================================================================================
        // üö© V6.4: RENDERING CORE
        // ==============================================================================================================

        /** V6.4: Render danh s√°ch ƒë·ªôi chi ti·∫øt l√™n Tab General (FIX L·ªñI) */
        function renderTeamList() {
            const container = document.getElementById('teamList');
            if (!container || !tournamentData || !tournamentData.tL) return;
            
            container.innerHTML = ''; 

            tournamentData.tL.forEach(team => {
                const teamElement = document.createElement('div');
                teamElement.className = 'p-4 rounded-xl shadow-lg bg-[var(--match-bg)] border border-[var(--border-color)] hover:border-[var(--accent-color)] transition duration-200';
                
                let playerDetails = team.P.map(player => `
                    <span class="text-xs text-gray-400">üë§ ${player.name} (${player.pL})</span>
                `).join('<br>');
                
                const stats = `
                    <div class="mt-2 pt-2 border-t border-[var(--border-color)] text-sm">
                        <span class="text-green-400 font-bold">Th·∫Øng: ${team.W || 0}</span> | 
                        <span class="text-red-400 font-bold">Thua: ${team.L || 0}</span> | 
                        <span class="text-blue-400 font-bold">ƒêi·ªÉm: ${team.Pts || 0}</span> |
                        <span class="text-yellow-400 font-bold">H·∫°ng (gR): ${team.gR || 'N/A'}</span>
                    </div>
                `;
                
                teamElement.innerHTML = `
                    <h3 class="text-xl font-bold text-[var(--accent-color)]">${team.T} (${team.Tn})</h3>
                    <p class="text-sm text-gray-400 mb-2">Group ${team.g} | Level ${team.aPL}</p>
                    <div class="space-y-1">${playerDetails}</div>
                    ${stats}
                `;
                container.appendChild(teamElement);
            });
        }

        /** V6.4: Render b·∫£ng x·∫øp h·∫°ng V√≤ng B·∫£ng (FIX L·ªñI HI·ªÇN TH·ªä '0') */
        function renderGroupTables(groupCode) {
            const containerId = `table${groupCode}`;
            const container = document.getElementById(containerId);
            if (!container || !tournamentData || !tournamentData.tL) return;

            const teams = tournamentData.tL
                .filter(team => team.g === groupCode)
                .sort((a, b) => (a.gR || 99) - (b.gR || 99));

            let tableHtml = `
                <h3 class="text-xl md:text-2xl font-bold text-[var(--group-header-text)] mb-4">
                    B·∫£ng X·∫øp H·∫°ng B·∫£ng ${groupCode}
                </h3>
                <div class="bg-[var(--match-bg)] rounded-lg shadow-lg overflow-hidden">
                    <table class="min-w-full divide-y divide-[var(--border-color)]">
                        <thead class="bg-[var(--card-bg)]">
                            <tr>
                                <th class="px-2 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider">H·∫°ng</th>
                                <th class="px-2 py-2 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">ƒê·ªôi</th>
                                <th class="px-2 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider">T</th>
                                <th class="px-2 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider">B</th>
                                <th class="px-2 py-2 text-center text-xs font-medium text-gray-400 uppercase tracking-wider">ƒêi·ªÉm</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-[var(--border-color)]">
            `;

            teams.forEach(team => {
                tableHtml += `
                    <tr class="hover:bg-[var(--card-bg)] transition duration-150">
                        <td class="px-2 py-1 border-b border-[var(--border-color)] text-center text-lg font-bold ${team.gR === 1 || team.gR === 2 ? 'text-green-500' : 'text-gray-400'}">${team.gR || 'N/A'}</td>
                        <td class="px-2 py-1 border-b border-[var(--border-color)] font-semibold text-sm">${team.Tn}</td>
                        <td class="px-2 py-1 border-b border-[var(--border-color)] text-center text-sm">${team.W || 0}</td>
                        <td class="px-2 py-1 border-b border-[var(--border-color)] text-center text-sm">${team.L || 0}</td>
                        <td class="px-2 py-1 border-b border-[var(--border-color)] text-center font-bold text-yellow-400 text-sm">${team.Pts || 0}</td>
                    </tr>
                `;
            });

            tableHtml += `
                        </tbody>
                    </table>
                </div>
            `;
            container.innerHTML = tableHtml;
        }


        /** V6.4: Render danh s√°ch tr·∫≠n ƒë·∫•u V√≤ng B·∫£ng (FIX L·ªñI HI·ªÇN TH·ªä Tn, t, c) */
        function renderGroupMatches(groupCode) {
            const containerId = `matches${groupCode}`;
            const container = document.getElementById(containerId);
            if (!container || !tournamentData) return;

            const matches = tournamentData[`matches${groupCode}`];
            if (!matches) {
                container.innerHTML = `<p class="text-center text-gray-500">Ch∆∞a c√≥ d·ªØ li·ªáu tr·∫≠n ƒë·∫•u cho B·∫£ng ${groupCode}.</p>`;
                return;
            }

            container.innerHTML = `
                <h3 class="text-xl md:text-2xl font-bold text-[var(--group-header-text)] mb-4">
                    Danh S√°ch Tr·∫≠n ƒê·∫•u B·∫£ng ${groupCode}
                </h3>
                <button onclick="commitScoreChangesToGitHub()" class="w-full md:w-auto px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-lg shadow-lg transition duration-300 mb-4 text-sm disabled:opacity-50">
                    COMMIT T·ªà S·ªê & THAY ƒê·ªîI ƒê·ªòI
                </button>
            `;

            matches.forEach((match) => {
                // L·∫•y th√¥ng tin ƒë·ªôi chi ti·∫øt
                const teamAInfo = getTeamInfo(match.A);
                const teamBInfo = getTeamInfo(match.B);

                // X√°c ƒë·ªãnh l·ªõp m√†u cho ƒë·ªôi th·∫Øng/thua
                const classA = match.Wn === match.A ? 'font-black text-green-400' : (match.Wn === match.B ? 'text-red-400 opacity-75' : 'font-semibold');
                const classB = match.Wn === match.B ? 'font-black text-green-400' : (match.Wn === match.A ? 'text-red-400 opacity-75' : 'font-semibold');

                const matchHtml = `
                    <div class="match-card p-3 rounded-lg flex flex-col md:flex-row items-center justify-between mb-2 transition duration-150" data-match-id="${match.Mc}">
                        
                        <div class="flex-shrink-0 text-xs text-gray-400 mb-2 md:mb-0 md:w-[20%] text-center md:text-left">
                            <span class="block font-bold text-[var(--accent-color)]">${match.t || 'N/A'}</span>
                            <span class="block">${match.c || 'N/A'}</span>
                        </div>
                        
                        <div class="flex flex-col space-y-2 w-full md:w-[80%]">
                            
                            <div class="flex items-center justify-between">
                                <span class="text-sm md:text-base w-3/4 truncate ${classA}" title="${teamAInfo.Tn}">${teamAInfo.Tn} (${match.A})</span>
                                <input type="number" 
                                        class="score-input w-1/4 max-w-[60px] p-1 text-center rounded-md text-sm" 
                                        value="${match.sA !== null ? match.sA : ''}" 
                                        min="0" 
                                        id="score-input-${match.Mc}-A"
                                        data-match="${match.Mc}" 
                                        data-team="A" 
                                        onchange="handleInputScore(this, '${match.Mc}', 'A')"
                                        placeholder="0">
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <span class="text-sm md:text-base w-3/4 truncate ${classB}" title="${teamBInfo.Tn}">${teamBInfo.Tn} (${match.B})</span>
                                <input type="number" 
                                        class="score-input w-1/4 max-w-[60px] p-1 text-center rounded-md text-sm" 
                                        value="${match.sB !== null ? match.sB : ''}" 
                                        min="0" 
                                        id="score-input-${match.Mc}-B"
                                        data-match="${match.Mc}" 
                                        data-team="B" 
                                        onchange="handleInputScore(this, '${match.Mc}', 'B')"
                                        placeholder="0">
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += matchHtml;
            });
        }

        // ... (renderKnockoutMatches, renderTeamManagement, renderFinalResults - c·∫ßn g·ªçi)

        /** H√†m ch√≠nh ƒë·ªÉ render l·∫°i to√†n b·ªô giao di·ªán sau khi thay ƒë·ªïi d·ªØ li·ªáu */
        function renderAllData() { 
             console.log("Rendering all data for V6.4..."); 
             
             // 1. H·ª£p nh·∫•t t·∫•t c·∫£ c√°c tr·∫≠n ƒë·∫•u v√† t√≠nh to√°n Wn/rU
             const allRounds = [...(tournamentData.matchesA || []), ...(tournamentData.matchesB || []), ...(tournamentData.matchesC || []), ...(tournamentData.matchesD || []), ...(tournamentData.quarterfinals || []), ...(tournamentData.semifinals || []), tournamentData.final];
             allRounds.forEach(match => match && calculateWinnerLoser(match));
             
             // 2. T√çNH TO√ÅN TH·ªêNG K√ä V√íNG B·∫¢NG (FIX L·ªñI HI·ªÇN TH·ªä '0')
             calculateGroupStatsAndRanks(); 
             
             // 3. C·∫≠p nh·∫≠t Seeding cho c√°c v√≤ng lo·∫°i
             updateSemiFinalSeeding(); 
             
             // 4. Render c√°c th√†nh ph·∫ßn UI (FIX L·ªñI ƒê·ªíNG B·ªò)
             renderFinalResults(); 
             renderTeamList(); 
             renderTeamManagement(); // C·∫ßn render l·∫°i ƒë·ªÉ c·∫≠p nh·∫≠t Tn, Name

             renderGroupTables('A'); renderGroupMatches('A'); 
             renderGroupTables('B'); renderGroupMatches('B'); 
             renderGroupTables('C'); renderGroupMatches('C'); 
             renderGroupTables('D'); renderGroupMatches('D'); 
             
             // ... (Logic v√¥ hi·ªáu h√≥a n√∫t Seeding - gi·ªØ nguy√™n)
        }
        
        // ... (C√°c h√†m loadDataFromGitHub, initializeApp, etc.)

        window.onload = initializeApp;
    </script>
</body>
</html>
